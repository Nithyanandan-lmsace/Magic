/**
 * Magic link expiration form define js.
 * @module   auth_magic
 * @copyright  2023 bdecent gmbh <https://bdecent.de>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("auth_magic/linkexpirytime",["core/fragment","core/modal_factory","core/modal_events","core/notification","core/str","core/ajax"],(function(Fragment,ModalFactory,ModalEvents,notification,String,Ajax){function showModal(params){document.querySelectorAll(".magic-loginlink_expiry").forEach((button=>{button.addEventListener("click",(function(e){e.preventDefault();var userid=e.currentTarget.getAttribute("data-id");params.userid=userid,ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:String.get_string("linkexpirytime","auth_magic"),body:getBodyContent(params),large:!0}).then((function(modal){return modal.getRoot().on(ModalEvents.save,(e=>{e.preventDefault(),modal.getRoot().find("form").submit()})),modal.getRoot().on("submit","form",(e=>{e.preventDefault(),function(userid){var modalform=document.querySelectorAll("#linkexpirytime form")[0],formData=new URLSearchParams(new FormData(modalform)).toString();Ajax.call([{methodname:"auth_magic_update_link_expiry_time",args:{userid:userid,formdata:formData},done:function(response){response.message&&notification.addNotification({message:response.message,type:"success"})}}])}(userid),modal.hide()})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show(),modal})).catch(notification.exception)}))}))}function getBodyContent(params){return Fragment.loadFragment("auth_magic","link_expiration_form",params.contextid,params)}return{init:function(params){showModal(params)}}}));

//# sourceMappingURL=linkexpirytime.min.js.map