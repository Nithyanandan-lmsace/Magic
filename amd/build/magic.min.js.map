{"version":3,"file":"magic.min.js","sources":["../src/magic.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n\r\n/**\r\n * Pro magic authentication define js.\r\n * @module   auth_magic\r\n * @copyright  2022 bdecent gmbh <https://bdecent.de>\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n define(['jquery', 'core/fragment', 'core/modal_factory', 'core/modal_events',\r\n    'core/notification', 'core/str', 'core/templates', 'core/ajax'],\r\n function($, Fragment, ModalFactory, ModalEvents, notification, Str, Templates, Ajax) {\r\n\r\n    var MAGIC;\r\n\r\n    /**\r\n     * Controls Custom styles tool action.\r\n     * @param {object} params\r\n     */\r\n    var Magic = function(params) {\r\n        var self = this;\r\n        MAGIC = this;\r\n\r\n        if (params.enrolstatus !== undefined) {\r\n            self.displayAuthInfoBox(params);\r\n        }\r\n\r\n        if (params.cancopylink !== undefined) {\r\n            self.copyuserLoginlink(params.cancopylink);\r\n        }\r\n\r\n        if (params.hascourseregister) {\r\n            self.courseQuickRegistration(params);\r\n        }\r\n\r\n        if (params.copycampaignlink !== undefined) {\r\n            self.copyCampaignLink(params, 'table .action-copy');\r\n            self.copyCampaignLink(params, 'table .action-couponlink');\r\n        }\r\n\r\n        if (params.campaignformfield !== undefined) {\r\n            self.vaildateCampaignFormFields();\r\n            self.changeFormField(params);\r\n            self.campaignHandler();\r\n        }\r\n\r\n        self.campaignCourse();\r\n        return true;\r\n    };\r\n\r\n    Magic.prototype.campaignCourse = function() {\r\n        var self = this;\r\n        var campaignCourse = document.querySelector(\"#fitem_id_campaigncourse select#id_campaigncourse\");\r\n        if (campaignCourse) {\r\n            campaignCourse.addEventListener(\"change\", function(e) {\r\n                self.setCampaigncourseGroupings(e.target.value, campaignCourse);\r\n                self.enrolmentKeyFormFieldHandler(e.target.value);\r\n            });\r\n            self.setCampaigncourseGroupings(campaignCourse.value, campaignCourse);\r\n            self.enrolmentKeyFormFieldHandler(campaignCourse.value);\r\n        }\r\n\r\n        var campaignGroup = document.querySelector(\"#fitem_id_campaigngroups select#id_campaigngroups\");\r\n        if (campaignGroup) {\r\n            campaignGroup.addEventListener(\"change\", function() {\r\n                self.setCampaigncourseGroupings(campaignCourse.value, campaignCourse);\r\n            });\r\n        }\r\n    };\r\n\r\n    Magic.prototype.enrolmentKeyFormFieldHandler = function(courseid) {\r\n        if (courseid == '0') {\r\n            if ($(\"#id_courseenrolmentkey option[value='strict']\").length > 0)  {\r\n                $(\"#id_courseenrolmentkey option[value='strict']\").remove();\r\n            }\r\n        } else {\r\n            if ($(\"#id_courseenrolmentkey option[value='strict']\").length == 0)  {\r\n                var strictStr = Str.get_string('campaigns:strict', 'auth_magic');\r\n                strictStr.done(function(localizedEditString) {\r\n                    $(\"#id_courseenrolmentkey\").append(\"<option value='strict'>\" +  localizedEditString + \"</option>\");\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    Magic.prototype.setCampaigncourseGroupings = function(courseid) {\r\n        var self = this;\r\n        var groupingElement = document.querySelector(\"#fitem_id_campaigngrouping select#id_campaigngrouping\");\r\n        $(\"#id_campaigncourseheadingcontainer .alert-info\").remove();\r\n\r\n        if (courseid == '0') {\r\n            return false;\r\n        }\r\n\r\n        groupingElement.innerHTML = '';\r\n        var disabledStr = Str.get_string('disabled', 'auth_magic');\r\n        disabledStr.done(function(localizedEditString) {\r\n            self.insertOptionSelectbox('0', localizedEditString, groupingElement);\r\n        });\r\n\r\n\r\n        Ajax.call([{\r\n            methodname: 'auth_magic_get_course_groupings',\r\n            args: {courseid: courseid, campaignid : $('input[name=\"campaignid\"]').attr('value')},\r\n            done: function(data) {\r\n                data.groupings.forEach((list) => {\r\n                    self.insertOptionSelectbox(list.id, list.name, groupingElement);\r\n                });\r\n                // Set the selected grouping.\r\n                if (data.courseinfo.campaign_grouping && $(\"select#id_campaigngrouping option[value=\" +\r\n                    data.courseinfo.campaign_grouping + \"]\").length) {\r\n                    groupingElement.value = data.courseinfo.campaign_grouping;\r\n                }\r\n\r\n                // Show separtegroup.\r\n                var campaignCourseHandler = document.querySelector(\"#fitem_id_campaigncourse\");\r\n                if (campaignCourseHandler) {\r\n                    if (!data.courseinfo.is_separtegroup) {\r\n                        campaignCourseHandler.insertAdjacentHTML(\"afterend\", data.courseinfo.separtegroupinfo);\r\n                    }\r\n\r\n                    if (!data.courseinfo.is_available_selfenrol) {\r\n                        campaignCourseHandler.insertAdjacentHTML(\"afterend\", data.courseinfo.selfenrolinfo);\r\n                        self.hideGrouping();\r\n                    } else {\r\n                        self.showGrouping();\r\n                    }\r\n                }\r\n            }\r\n        }]);\r\n    };\r\n\r\n    Magic.prototype.hideGrouping = function() {\r\n        $(\"#fitem_id_groupcapacity\").hide();\r\n        $(\"#fitem_id_campaigngrouping\").hide();\r\n    };\r\n\r\n    Magic.prototype.showGrouping = function() {\r\n        $(\"#fitem_id_groupcapacity\").show();\r\n        $(\"#fitem_id_campaigngrouping\").show();\r\n    };\r\n\r\n    Magic.prototype.insertOptionSelectbox = function(value, text, element) {\r\n        var option = document.createElement(\"option\");\r\n        option.value = value;\r\n        option.text = text;\r\n        element.add(option);\r\n    };\r\n\r\n    Magic.prototype.campaignHandler = function() {\r\n        var self = this;\r\n        var fieldHandler = document.querySelector(\"#id_securitysectioncontainer #fitem_id_emailconfirm select\");\r\n        if (fieldHandler) {\r\n            fieldHandler.addEventListener(\"change\", function(e) {\r\n                self.campaignSubmissionHandler(e.target.value);\r\n            });\r\n            self.campaignSubmissionHandler(fieldHandler.value);\r\n        }\r\n    };\r\n\r\n    Magic.prototype.campaignSubmissionHandler = function(value) {\r\n        var submissonHandler = document.querySelector(\"#fitem_id_redirectaftersubmisson select#id_redirectaftersubmisson\");\r\n        var submissonHandlerOptions = Array.from(submissonHandler.options).map((opt) => opt.value);\r\n        var addOption = document.createElement(\"option\");\r\n        addOption.value = \"redirecturl\";\r\n        var redirecturlStr = Str.get_string('campaigns:redirecturl', 'auth_magic');\r\n        redirecturlStr.done(function(localizedEditString) {\r\n            addOption.text = localizedEditString;\r\n        });\r\n\r\n        if (value == '1') {\r\n            if (submissonHandlerOptions.includes(\"redirecturl\")) {\r\n                submissonHandler.options.remove(submissonHandler.options.length - 1);\r\n            }\r\n        } else {\r\n            if (!submissonHandlerOptions.includes(\"redirecturl\")) {\r\n                submissonHandler.options.add(addOption);\r\n            }\r\n        }\r\n    };\r\n\r\n    Magic.prototype.changeFormField = function(params) {\r\n        var self = this;\r\n        var fieldHandler = document.querySelector(\"#id_formfieldsection #fitem_id_linkfields select\");\r\n        if (fieldHandler) {\r\n            fieldHandler.addEventListener(\"change\", function(e) {\r\n                params.relateduser = e.target.value;\r\n                params.currentcampaignid = $('input[name=\"campaignid\"]').attr('value');\r\n                self.getUserFormField(params);\r\n            });\r\n        }\r\n    };\r\n\r\n    Magic.prototype.getUserFormField = function(params) {\r\n        var self = this;\r\n        var fragment =  Fragment.loadFragment('auth_magic', 'get_user_formfield', params.contextid, params);\r\n        document.querySelectorAll(\"body\")[0].classList.add(\"load-icon\");\r\n        fragment.done(function(html, js) {\r\n            // Remove the mform based unique id.\r\n            var currentMformID = $(\"#page-auth-magic-campaigns-edit .mform\").attr(\"id\");\r\n            js = js.replace(/mform1_[A-Za-z0-9]+/g, currentMformID);\r\n            var tempElement = document.createElement('div');\r\n            tempElement.innerHTML = html;\r\n\r\n            // Remove the collaspse section js.\r\n            var collapseSectionsId = $(\"#\" + currentMformID + \" .collapsible-actions a\").attr(\"id\");\r\n            if (collapseSectionsId) {\r\n                js = js.replace(/#collapsesections[A-Za-z0-9]+/g, \"#\" + collapseSectionsId);\r\n            }\r\n\r\n            // Remove the filemanager js.\r\n            var formfields = tempElement.querySelector('#id_formfieldsection');\r\n            $(\"#page-auth-magic-campaigns-edit .mform #id_formfieldsection\").replaceWith(formfields);\r\n            // Implement the show expand formfield section .\r\n            $(\"#id_formfieldsection a[data-toggle='collapse']\").attr(\"aria-expanded\", \"true\");\r\n            $(\"#id_formfieldsection a[data-toggle='collapse']\").removeClass(\"collapsed\");\r\n            $(\"#id_formfieldsection #id_formfieldsectioncontainer\").addClass(\"show\");\r\n            Templates.runTemplateJS(js);\r\n            $(\"#id_formfieldsection select#id_linkfields\").val(params.relateduser);\r\n            document.querySelectorAll(\"body\")[0].classList.remove(\"load-icon\");\r\n        }.bind(self)).fail(notification.exception);\r\n    };\r\n\r\n    Magic.prototype.vaildateCampaignFormFields = function() {\r\n        var self = this;\r\n        var otherFiedlsHandler = document.querySelectorAll(\"#id_formfieldsection .campaign_otherform_fields select\");\r\n        if (otherFiedlsHandler) {\r\n            otherFiedlsHandler.forEach((item) => {\r\n                // When change the field handler element remove the others boxes.\r\n                item.addEventListener(\"change\", function(e) {\r\n                    self.rearrangeFormFields(e.target);\r\n                });\r\n                self.disableEmptyField(item);\r\n                self.rearrangeFormFields(item);\r\n            });\r\n        }\r\n    };\r\n\r\n    Magic.prototype.disableEmptyField = function(currentElement) {\r\n        if (currentElement.options.length == 0) {\r\n            setTimeout(function() {\r\n                var option = document.createElement(\"option\");\r\n                option.value = \"none\";\r\n                var none = Str.get_string('none', 'auth_magic');\r\n                none.done(function(localizedEditString) {\r\n                    option.text = localizedEditString;\r\n                });\r\n                option.selected = true;\r\n                currentElement.options.add(option);\r\n                currentElement.disabled = true;\r\n            }, 500);\r\n            var currentField = currentElement.getAttribute('data-field'); // Last name\r\n            var currentFieldOption = document.querySelector(\"select[name='\" + currentField + \"_option']\");\r\n            var optionLabels = Array.from(currentFieldOption.options).map((opt) => opt.value);\r\n            if (optionLabels.includes(\"50\")) {\r\n                currentFieldOption.options.remove(currentFieldOption.options.length - 1);\r\n            }\r\n        }\r\n    };\r\n\r\n    Magic.prototype.rearrangeFormFields = function(currentElement) {\r\n        var self = this;\r\n        var currentSelectval = currentElement.value;\r\n        if (currentSelectval) {\r\n            var currentField = currentElement.getAttribute('data-field'); // Get current form field.\r\n            // Get form field select element.\r\n            var changeSelectField = document.querySelector(\"#id_formfieldsection .campaign_otherform_fields #id_\"\r\n                + currentSelectval + \"_otherfield\");\r\n            if (changeSelectField) {\r\n                // Get form field all options.\r\n                var changeSelectFieldValues = self.getFieldDefaultValues(currentSelectval);\r\n                var changeSelectFieldDefault = changeSelectField.value;\r\n                // Remove the form field all options.\r\n                for (var i = changeSelectField.options.length; i >= 0; i--) {\r\n                    changeSelectField.options.remove(i);\r\n                }\r\n                // Add the form field options (Removing the related one).\r\n                // (one or more same element selected to the field, that field remove the them. )\r\n                // Example (lastname & city field select to \"username option\")\r\n                // then (Username field remove the lastname & city both options).\r\n                for(var j = 0; j < changeSelectFieldValues.length; j++) {\r\n                    let optionfield = document.querySelector(\"select[name='\" +\r\n                        Object.keys(changeSelectFieldValues[j]) + \"_otherfield']\");\r\n                    if (optionfield != undefined && optionfield.value != currentSelectval) {\r\n                        var option = document.createElement(\"option\");\r\n                        option.value = Object.keys(changeSelectFieldValues[j]);\r\n                        option.text = Object.values(changeSelectFieldValues[j]);\r\n                        if (changeSelectFieldDefault == option.value) {\r\n                            option.selected = true;\r\n                        }\r\n                        changeSelectField.options.add(option);\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            // Below set of codes to the insert the option. When modifiy to select.\r\n            // Example (above (lastname & city field select to \"username option\"))\r\n            // User changed to the  lastname field to other one.\r\n            // Result: \"Username\" field add the lastname option.\r\n\r\n            // Add the provious select value.\r\n            var currentFieldPreValue = document.querySelector(\"input[name='\" + currentField + \"_otherfield_prevalue']\");\r\n            // Check provious value exit add the value.\r\n            if (currentFieldPreValue != undefined && currentFieldPreValue.value != \"\") {\r\n                var fieldPreValues = self.getFieldDefaultValues(currentFieldPreValue.value);\r\n                var index = fieldPreValues.findIndex(function(obj) {\r\n                    return obj.hasOwnProperty(currentField);\r\n                });\r\n                if (index) {\r\n                    var changePreSelectField = document.querySelector(\"#id_formfieldsection .campaign_otherform_fields #id_\" +\r\n                        currentFieldPreValue.value + \"_otherfield\");\r\n                    if (changePreSelectField) {\r\n                        var option = document.createElement(\"option\");\r\n                        option.value = Object.keys(fieldPreValues[index]);\r\n                        option.text = Object.values(fieldPreValues[index]);\r\n                        changePreSelectField.insertBefore(option, changePreSelectField.options[index]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (currentFieldPreValue) {\r\n                currentFieldPreValue.value = currentSelectval;\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    Magic.prototype.getFieldDefaultValues = function(currentSelectval) {\r\n        var changeSelectFieldValues = [];\r\n        var changeSelectFieldOptions = document.querySelectorAll(\"input[name='\" + currentSelectval + \"_otherfield_value[]']\");\r\n        changeSelectFieldOptions.forEach(function(inputElement) {\r\n            var val = {};\r\n            val[inputElement.value] = inputElement.getAttribute('data-value');\r\n            changeSelectFieldValues.push(val);\r\n        });\r\n        return changeSelectFieldValues;\r\n    };\r\n\r\n    Magic.prototype.courseQuickRegistration = function(params) {\r\n        var uniqueid = \"user-index-participants-\" + params.courseid;\r\n        var handleSelector = \".pagelayout-incourse [data-table-uniqueid=\" + uniqueid + \"]\";\r\n        var addHandler = document.querySelectorAll(handleSelector);\r\n        if (addHandler) {\r\n            var singleButton = document.createElement(\"div\");\r\n            singleButton.setAttribute(\"class\", \"singlebutton quickregister-button\");\r\n\r\n            // Create a form.\r\n            var form = document.createElement(\"form\");\r\n            form.setAttribute(\"method\", \"get\");\r\n            form.setAttribute(\"action\", params.url);\r\n            form.setAttribute(\"id\", \"quickregister-button\");\r\n\r\n            // Create an input element for Full Name\r\n            var courseblock = document.createElement(\"input\");\r\n            courseblock.setAttribute(\"type\", \"hidden\");\r\n            courseblock.setAttribute(\"name\", \"courseid\");\r\n            courseblock.setAttribute(\"value\", params.courseid);\r\n\r\n            var submit = document.createElement(\"input\");\r\n            submit.setAttribute(\"type\", \"submit\");\r\n            submit.setAttribute(\"value\", params.strquickregister);\r\n            submit.setAttribute(\"class\", \"btn btn-secondary my-1\");\r\n\r\n            form.appendChild(courseblock);\r\n            form.appendChild(submit);\r\n            singleButton.appendChild(form);\r\n            addHandler[0].appendChild(singleButton);\r\n        }\r\n    };\r\n\r\n    Magic.prototype.copyuserLoginlink = function(cancopylink) {\r\n        var self = this;\r\n        if (cancopylink) {\r\n            var invitationlink = document.querySelectorAll(\"table.magicinvitationlink .magic-invitationlink\");\r\n            if (invitationlink) {\r\n                invitationlink.forEach(function(items) {\r\n                    items.addEventListener('click', function(e) {\r\n                        e.preventDefault();\r\n                        var userlogin = e.currentTarget.getAttribute(\"data-invitationlink\");\r\n                        self.copyText(userlogin);\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    Magic.prototype.copyTextCliboard = function() {\r\n        var self = this;\r\n        var copyTextBlock = document.querySelectorAll(\".auth-magic-block #copy-text\")[0];\r\n        if (copyTextBlock) {\r\n            self.copyText(copyTextBlock.value, true);\r\n            copyTextBlock.select();\r\n        }\r\n    };\r\n\r\n    Magic.prototype.copyText = function(copytext, modal = false) {\r\n        if (typeof (navigator.clipboard) == 'undefined') {\r\n            var textArea = document.createElement(\"textarea\");\r\n            textArea.value = copytext;\r\n            // Avoid scrolling to bottom\r\n            textArea.style.top = \"0\";\r\n            textArea.style.left = \"0\";\r\n            textArea.style.position = \"fixed\";\r\n            if (!modal) {\r\n                document.body.appendChild(textArea);\r\n            } else {\r\n                document.querySelectorAll(\".modal .modal-content\")[0].appendChild(textArea);\r\n            }\r\n            textArea.focus();\r\n            textArea.select();\r\n            try {\r\n                document.execCommand('copy');\r\n            } catch (err) {\r\n                return false;\r\n            }\r\n            if (!modal) {\r\n                document.body.removeChild(textArea);\r\n            } else {\r\n                document.querySelectorAll(\".modal .modal-content\")[0].removeChild(textArea);\r\n            }\r\n        } else {\r\n            navigator.clipboard.writeText(copytext);\r\n        }\r\n        return true;\r\n    };\r\n\r\n    Magic.prototype.copyCampaignLink = function(params, element) {\r\n        var copyCampaign = document.querySelectorAll(element);\r\n        copyCampaign.forEach((campaign) => {\r\n            campaign.addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n\r\n                var target = e.currentTarget;\r\n                var link = target.dataset.campaignlink;\r\n                params.campaignlink = link;\r\n                params.campaign = true;\r\n\r\n                ModalFactory.create({\r\n                    title: params.campaigntitle,\r\n                    type: ModalFactory.types.CANCEL,\r\n                    body: Templates.render('auth_magic/modalbox', params),\r\n                    large: true\r\n                }).then(function(modal) {\r\n                    modal.show();\r\n                    modal.getRoot().on(ModalEvents.bodyRendered, function() {\r\n                        var copyBoardButton = document.querySelectorAll(\".auth-magic-block .copy-link-block #copy-cliboard\")[0];\r\n                        if (copyBoardButton) {\r\n                            copyBoardButton.addEventListener(\"click\", () => {\r\n                                MAGIC.copyText(link);\r\n                                var copyBoardElement = document.querySelectorAll(\".auth-magic-block #copy-campaign-link\")[0];\r\n                                if (copyBoardElement) {\r\n                                    copyBoardElement.select();\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        modal.destroy();\r\n                    });\r\n                    return modal;\r\n                }).catch(notification.exception);\r\n\r\n            });\r\n        });\r\n    };\r\n\r\n    Magic.prototype.getAuthMagicBody = function(params) {\r\n        return Fragment.loadFragment('auth_magic', 'display_box_content', params.contextid, params);\r\n    };\r\n\r\n    Magic.prototype.getAuthMagicCampaignBody = function(params) {\r\n        return Fragment.loadFragment('auth_magic', 'get_campaign_body', params.contextid, params);\r\n    };\r\n\r\n\r\n    Magic.prototype.displayAuthInfoBox = function(params) {\r\n        var self = this;\r\n        ModalFactory.create({\r\n            title: params.strconfirm,\r\n            type: ModalFactory.types.CANCEL,\r\n            body: self.getAuthMagicBody(params),\r\n            large: true\r\n        }).then(function(modal) {\r\n            modal.show();\r\n            modal.getRoot().on(ModalEvents.bodyRendered, function() {\r\n                var copyBoardButton = document.querySelectorAll(\".auth-magic-block .copy-link-block #copy-cliboard\")[0];\r\n                if (copyBoardButton) {\r\n                    copyBoardButton.addEventListener(\"click\", self.copyTextCliboard.bind(self));\r\n                }\r\n            });\r\n            modal.getRoot().on(ModalEvents.hidden, function() {\r\n                modal.destroy();\r\n                window.open(params.returnurl, '_self');\r\n            });\r\n            return modal;\r\n        }).catch(notification.exception);\r\n    };\r\n\r\n    Magic.prototype.getAuthMagicBody = function(params) {\r\n        return Fragment.loadFragment('auth_magic', 'display_box_content', params.contextid, params);\r\n    };\r\n\r\n    return {\r\n        init: function(params) {\r\n            return new Magic(params);\r\n        }\r\n    };\r\n\r\n });\r\n"],"names":["define","$","Fragment","ModalFactory","ModalEvents","notification","Str","Templates","Ajax","MAGIC","Magic","params","this","undefined","enrolstatus","displayAuthInfoBox","cancopylink","copyuserLoginlink","hascourseregister","courseQuickRegistration","copycampaignlink","copyCampaignLink","campaignformfield","vaildateCampaignFormFields","changeFormField","campaignHandler","campaignCourse","prototype","self","document","querySelector","addEventListener","e","setCampaigncourseGroupings","target","value","enrolmentKeyFormFieldHandler","campaignGroup","courseid","length","remove","get_string","done","localizedEditString","append","groupingElement","innerHTML","insertOptionSelectbox","call","methodname","args","campaignid","attr","data","groupings","forEach","list","id","name","courseinfo","campaign_grouping","campaignCourseHandler","is_separtegroup","insertAdjacentHTML","separtegroupinfo","is_available_selfenrol","showGrouping","selfenrolinfo","hideGrouping","hide","show","text","element","option","createElement","add","fieldHandler","campaignSubmissionHandler","submissonHandler","submissonHandlerOptions","Array","from","options","map","opt","addOption","includes","relateduser","currentcampaignid","getUserFormField","fragment","loadFragment","contextid","querySelectorAll","classList","html","js","currentMformID","replace","tempElement","collapseSectionsId","formfields","replaceWith","removeClass","addClass","runTemplateJS","val","bind","fail","exception","otherFiedlsHandler","item","rearrangeFormFields","disableEmptyField","currentElement","setTimeout","selected","disabled","currentField","getAttribute","currentFieldOption","currentSelectval","changeSelectField","changeSelectFieldValues","getFieldDefaultValues","changeSelectFieldDefault","i","j","optionfield","Object","keys","values","currentFieldPreValue","fieldPreValues","index","findIndex","obj","hasOwnProperty","changePreSelectField","insertBefore","inputElement","push","handleSelector","addHandler","singleButton","setAttribute","form","url","courseblock","submit","strquickregister","appendChild","invitationlink","items","preventDefault","userlogin","currentTarget","copyText","copyTextCliboard","copyTextBlock","select","copytext","modal","navigator","clipboard","textArea","style","top","left","position","body","focus","execCommand","err","removeChild","writeText","campaign","link","dataset","campaignlink","create","title","campaigntitle","type","types","CANCEL","render","large","then","getRoot","on","bodyRendered","copyBoardButton","copyBoardElement","hidden","destroy","catch","getAuthMagicBody","getAuthMagicCampaignBody","strconfirm","window","open","returnurl","init"],"mappings":"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"}