/**
 * Magic campaign welcome and follow up message placeholders define js.
 *
 * @module   auth_magic
 * @copyright  2023 bdecent gmbh <https://bdecent.de>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("auth_magic/messagevars",[],(function(){return{init:function(){var notificationheader,messageVars=this;null!==(notificationheader=document.getElementById("id_welcomemessagesection_editor"))&&notificationheader.addEventListener("click",(function(){var EditorInput=document.getElementById("id_welcomemessagecontent_editoreditable");null!==EditorInput&&messageVars.insertCaretActive(EditorInput)})),null!==(notificationheader=document.getElementById("id_followupmessagesection"))&&notificationheader.addEventListener("click",(function(){var EditorInput=document.getElementById("id_followupmessagecontent_editoreditable");null!==EditorInput&&messageVars.insertCaretActive(EditorInput)})),null!==(notificationheader=document.getElementById("id_aftersubmisson"))&&notificationheader.addEventListener("click",(function(){var EditorInput=document.getElementById("id_submissioncontent_editoreditable");null!==EditorInput&&messageVars.insertCaretActive(EditorInput)}));var targetNode=document.querySelector("textarea[id$=_editor]");null!==targetNode&&new MutationObserver((function(){"none"==targetNode.style.display&&setTimeout(initIframeListeners,100)})).observe(targetNode,{attributes:!0,childList:!0});const initIframeListeners=()=>{var iframes=document.querySelectorAll('[data-fieldtype="editor"] iframe');return!(null===iframes||!iframes.length)&&(iframes.forEach((iframe=>{iframe.contentDocument.addEventListener("click",(function(e){var currentFrame=e.target;iframes.forEach((frame=>{var frameElem=frame.contentDocument.querySelector(".insertatcaretactive");null!==frameElem&&frameElem.classList.remove("insertatcaretactive")}));var contentBody=currentFrame.querySelector("body");null!==contentBody&&contentBody.classList.add("insertatcaretactive")}))})),!0)};for(var clickforword=document.getElementsByClassName("campaign-message-clickforword"),i=0;i<clickforword.length;i++)clickforword[i].addEventListener("click",(function(e){e.preventDefault();var tinyEditor=!1,content="{"+this.getAttribute("data-text")+"}",iframes=document.querySelectorAll('[data-fieldtype="editor"] iframe');return null!==iframes&&iframes.length?(iframes.forEach((function(frame){if(null!==frame.contentDocument.querySelector(".insertatcaretactive")){var contentBody=frame.contentDocument.querySelector("body");if(null!==contentBody){contentBody.classList.add("insertatcaretactive");var id=contentBody.dataset.id,editor=window.tinyMCE.get(id);tinyEditor=editor}}})),tinyEditor?tinyEditor.selection.setContent(content):messageVars.insertAtCaret(content),!0):(messageVars.insertAtCaret(content),!0)}))},insertCaretActive:function(EditorInput){for(var caret=document.getElementsByClassName("insertatcaretactive"),j=0;j<caret.length;j++)caret[j].classList.remove("insertatcaretactive");EditorInput.classList.add("insertatcaretactive")},insertAtCaret:function(myValue){for(var sel,range,caretelements=document.getElementsByClassName("insertatcaretactive"),n=0;n<caretelements.length;n++){var thiselem=caretelements[n];if(void 0===thiselem.value&&window.getSelection){if((sel=window.getSelection()).getRangeAt&&sel.rangeCount){(range=sel.getRangeAt(0)).deleteContents(),range.insertNode(document.createTextNode(myValue));for(let position=0;position!=myValue.length+1;position++)sel.modify("move","right","character")}}else void 0===thiselem.value&&document.selection&&document.selection.createRange&&((range=document.selection.createRange()).text=myValue);if(void 0!==thiselem.value)if(document.selection)thiselem.focus(),(sel=document.selection.createRange()).text=myValue,thiselem.focus();else if(thiselem.selectionStart||"0"==thiselem.selectionStart){var startPos=thiselem.selectionStart,endPos=thiselem.selectionEnd;thiselem.value=thiselem.value.substring(0,startPos)+myValue+thiselem.value.substring(endPos,thiselem.value.length),thiselem.focus(),thiselem.selectionStart=startPos+myValue.length,thiselem.selectionEnd=startPos+myValue.length,thiselem.focus()}else thiselem.value+=myValue,thiselem.focus()}}}}));

//# sourceMappingURL=messagevars.min.js.map